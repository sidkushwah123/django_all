{% extends 'admin/base-template.html' %}
{% block content %}
{% load static %}
		 <div class="page-content">
		 <section class="content-header">
        
        <div class="header-title">
            <h1>{{Page_title}}</h1>
            
            
        </div>
    </section>
       {% if messages %}
    {% for message in messages %}
        
<div class="alert alert-success alert-dismissible">
                      <a href="#" class="close" data-dismiss="alert" aria-label="close" style="color: crimson!important">&times;</a>
                      <strong>{{message}}</strong> 
                    </div>
      
    {% endfor %}
    {% endif %}
<div class="container-fluid">
  <div class="row p-t-b-20">
    <div class="col-md-12">
      <!-- <div class="card no-b"> -->
      {% if form.errors %}
    {% for field in form %}
        {% for error in field.errors %}
            <div class="alert alert-danger">
                <strong>{{field.title}}  {{ error|escape }}</strong>
            </div>
        {% endfor %}
    {% endfor %}
    {% for error in form.non_field_errors %}
        <div class="alert alert-danger">
            <strong>{{ error|escape }}</strong>
        </div>
    {% endfor %}
{% endif %}
<div class="login-form-content">
  <form action="" method="POST" enctype='multipart/form-data'>
    {% csrf_token %}  
     
      <div class="panel-group" id="accordion">
    <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a class="accordion-toggle" id="first_tab" data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
          
          Add Information
        </a>
      </h4>
    </div>
    <div id="collapseOne" class="panel-collapse collapse show in">
      <div class="panel-body">
       <div class="row">
        <div class="col-md-6">   
              <label class="age">Select*  <span id="show_error_message_Select_Type" style="color:red;"> </span></label>
                       {{form.Select_Type}}
                        </div>
            
             <div class="col-md-6">
        <div class="form-group">
                   <label class="age">Product Name* <span id="show_error_message_Product_name" style="color:red;"> </span></label>
                   {{form.Product_name}}

        </div>
      </div>
    <div class="col-md-6">
        <div class="form-group scroll_cat">
                   <label class="age">Producer Name/Winery* <span id="show_error_message_Producer" style="color:red;"> </span></label>
                   {{form.Producer}}

        </div>
      </div>
    <div class="col-md-6">
        <div class="form-group scroll_cat">
                   <label class="age">Category* <span id="show_error_message_Category" style="color:red;"> </span></label>
                   
                                       
                                     {{form.Category}}
                            

        </div>
      </div>
    
  
    
    <div class="col-md-6">
        <div class="form-group">
                   <label class="age">Color* <span id="show_error_message_Color" style="color:red;"> </span></label>
            {{form.Color}}
                  

        </div>
      </div>
    <div class="col-md-6">
        <div class="form-group">
                   <label class="age">Appellation* <span id="show_error_message_Appellation" style="color:red;"> </span></label>
           {{form.Appellation}}
                  

        </div>
      </div>
    
    <div class="col-md-6">
        <div class="form-group">
                   <label class="age">Bottle Size* <span id="show_error_message_Bottel_Size" style="color:red;"> </span> </label>
       {{form.Bottel_Size}}
                  

        </div>
      </div>
      
   
  <div class="col-md-6">
        <div class="form-group">
                   <label class="age">Classification* <span id="show_error_message_Classification" style="color:red;"> </span></label>
          {{form.Classification}}
                  

        </div>
      </div>



      <div class="col-md-6">
        <div class="form-group scroll_cat">
                   <label class="age">Vintage* <span id="show_error_message_Vintage" style="color:red;"> </span></label>
           {{form.Vintage}}
                  

        </div>
      </div>
    
    <div class="col-md-6">
        <div class="form-group scroll_cat">
                   <label class="age">Varietals* <span id="show_error_message_Varietals" style="color:red;"> </span></label>
           {{form.Varietals}}
           
                  

        </div>
      </div>
    <div class="col-md-6">
        <div class="form-group">
                   <label class="age">Country* <span id="show_error_message_Country" style="color:red;"> </span></label>
          {{form.Country}}
          
                  

        </div>
      </div>
    <div class="col-md-6">
        <div class="form-group">
                   <label class="age">Regions* <span id="show_error_message_Regions" style="color:red;"> </span></label>
           {{form.Regions}}
                  

        </div>
      </div>
    <div class="col-md-6">
        <div class="form-group">
                   <label class="age">Grape* <span id="show_error_message_Grape" style="color:red;"> </span></label>
           {{form.Grape}}
                  

        </div>
      </div>
    <div class="col-md-6">
        <div class="form-group">
                   <label class="age">Status  {{get_product_ins.Status}}</label>
           <select  class="form-control " name="product_status">
           {% if get_product_ins.Status%}
           <option>Activate</option>
           <option>Deactivate</option>
           {% else %}
           <option>Deactivate</option>
           <option>Activate</option>
           {% endif %}
           
           </select>
                  

        </div>
      </div>
    
    <div class="col-md-12">
        <div class="form-group">
                   <label class="age">Description</label>
           <div class="summernote">
           {{form.Description}}
           </div>
                  

        </div>
      </div>
    
    
     </div>
     
     <div class="row">
  <div class="col-md-2">
    <button type="reset" class="btn-block btn btn-white subbtn" data-dismiss="modal">Cancel</button>
  </div>
  <div class="col-md-3">
    <div class="form-group">
      <button type="button" class="btn-block btn btn-white subbtn click_to_stope_submit product_info_section"  >Next</button>  
    </div>
  </div>
  <div class="col-md-5">
    <div class="form-group">
    <span id="show_error_message" style="color:red;"> </span>
    </div>
  </div>
</div>
     
     
      </div>
    </div>
  </div>

   <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a class="accordion-toggle collapsed" id="second_tab" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">
          
         Add Product Image
        </a>
      </h4>
    </div>
    <div id="collapseTwo" class="panel-collapse collapse">
      <div class="panel-body">
        <div class="row">
  
   <div class="col-md-12">
    <div class="form-group">
      <label class="age">Product Thumbnail</label>
    <input type="file" id="add_product_thumbnail" class="form-control">
    <input type="hidden" name="product_thumbnail_image" id="product_thumbnail_image" value="">
    </div>
        <div class="form-group" id="show_product_thumbnail">
             {% if get_product_ins.Product_image %}      
           <img src="{{get_product_ins.Product_image.url}}" style="width:64px; height:142px;">
        {% endif %}
          

        </div>
      </div>

      <div class="col-md-12">
        <div class="form-group">
                   <label class="age">Multiple Images</label>
           <input type="file" id="add_product_image" class="form-control">
                  

        </div>
      </div>
       <div class="col-md-12" id="show_images">
        {% if get_product_image %}
        {% for items in get_product_image %}
          {% if items.Image_Type == "Product_image" %}
        <div class="col-md-2 remove_this_div"><div class="form-group"><div class="three3d"><div class="delectimg"><span><i class="icon-close2 remove_div"></i></span><input type="hidden" name="product_images_old[]" value="{{items.id}}"><img src="{{items.Image.url}}"></div></div></div></div>
        {% endif %}
        {% endfor %}
        {% endif %}
      
      </div>
    
     
    <div class="col-md-12">
        <div class="form-group">
                   <label for="chkPassport" style="width:100%;">
    {% if get_product_banner_image %}
    <input type="checkbox" id="chkPassport" checked="" name="add_banner_image">
    {% else %}
    <input type="checkbox" id="chkPassport" name="add_banner_image">
    {% endif %}

  
    Background Cover Photo

</label>
                  

        </div>
      </div>
    
    <div class="col-md-12" id="dvPassport" {% if get_product_banner_image %} style="display: block" {% else %} style="display: none" {% endif %}>
    <div class="form-group">
    <input type="file" id="add_product_banner" class="form-control">
    <input type="hidden" name="product_banner_image" id="product_banner_image" value="">
    </div>
        <div class="form-group" id="show_images_banner">
             {% if get_product_banner_image %}      
           <img src="{{get_product_banner_image.Image.url}}">
        {% endif %}
          

        </div>
      </div>
    
   
    
     </div>
     
     <div class="row">
  <div class="col-md-2">
    <button type="button" class="btn-block btn btn-white subbtn" data-dismiss="modal">Cancel</button>
  </div>
  <div class="col-md-3">
    <div class="form-group">
      <button type="button" class="btn-block btn btn-white subbtn" data-toggle="collapse" data-parent="#accordion" href="#collapseThree">Next</button>
    </div>
  </div>
</div>
     
      </div>
    </div>
  </div> 
  
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThree">
          
          Price And Stock
        </a>
      </h4>
    </div>
    <div id="collapseThree" class="panel-collapse collapse">
      <div class="panel-body">
         <input type="hidden" id="old_year_value" value="{{get_product_ins.Vintage.all|join:'|'}}">
    <div class="table-responsive " id="show_vintage_year_stock_data">
     
          {% if year_list %}
{% for year in year_list %}

<div class="since_{{year}}">
   <table width="100%" border="1" class="table table-striped table-bordered newpage editableTable" align="center" cellpadding="0" cellspacing="0" style=" font-size: 15px;">
      <thead>
         <tr style="cursor: pointer;">
            <td colspan="9">
               <div class="yearwine"><span>{{year}}<span></span></span></div>
            </td>
            <td>
               <div class="add_button year_add add_rows" data-vintage_year="{{year}}"> <a class="add-row"><i class="fa fa-plus"></i>Add Row</a></div>
            </td>
         </tr>
         <tr style="cursor: pointer;">
            <th align="left" valign="top">Bottle</th>
            <th align="left" valign="top">Retail Cost</th>
            <th align="left" valign="top">Retail Stock</th>
            <th align="left" valign="top">Discount Cost</th>
            <th align="left" valign="top">Duty</th>
            <th align="left" valign="top">GST (%)</th>
            <th align="left" valign="top">Bond Cost</th>
            <th align="left" valign="top">Bond Stock</th>
            <th align="left" valign="top">Bond Descount Cost</th>
            <th align="left" valign="top">Action</th>
         </tr>
      </thead>
      <tbody class="add_row_{{year}}">
        {% if get_price_and_cost %}
        {% for cost_items in get_price_and_cost %}
      
        {% if cost_items.Vintage_Year.Vintages_Year == year %}
         <tr style="cursor: pointer;">
            <td data-field="name" style="width: 75px;">
              <input type="text" name="{{year}}_bottle[]" value="{% if cost_items.Bottle %} {{cost_items.Bottle}} {% else %} 0 {% endif %}" class="{{year}}_bottle"></td>
            <td data-field="name" style="width: 116px;">
              <input type="text" style="width: 100px;" class="{{year}}_retail_cose" value="{% if cost_items.Retail_Cost %} {{cost_items.Retail_Cost}}{% else %} 0 {% endif %}" name="{{year}}_retail_cose[]"></td>
            <td data-field="name" style="width: 126px;">
              <input type="text" name="{{year}}_retail_stock[]" value="{% if cost_items.Retail_Stock %} {{cost_items.Retail_Stock}}{% else %} 0 {% endif %}" class="{{year}}_retail_stock" style="width: 100px;"></td>
            <td data-field="name" style="width: 147px;">
              <input type="text" name="{{year}}_descount_cose[]" class="{{year}}_descount_cose" value="{% if cost_items.Descount_Cost %} {{cost_items.Descount_Cost}}{% else %} 0 {% endif %}" style="width: 100px;"> </td>
            <td data-field="name" style="width: 63px;">
              <input type="text" name="{{year}}_duty[]" class="{{year}}_duty" value="{% if cost_items.Duty %} {{cost_items.Duty}}{% else %} 0 {% endif %}" style="width: 65px;"></td>
            <td data-field="name" style="width: 70px;">
              <input type="text" name="{{year}}_GST[]" value="{% if cost_items.GST %} {{cost_items.GST}}{% else %} 0 {% endif %}" class="{{year}}_GST" style="width: 65px;"> </td>
            <td data-field="name" style="width: 115px;">
              <input type="text" name="{{year}}_bond_cose[]" value="{% if cost_items.Bond_Cost %} {{cost_items.Bond_Cost}}{% else %} 0 {% endif %}" class="{{year}}_bond_cose" style="width: 100px;"></td>
            <td data-field="name" style="width: 125px;">
              <input type="text" name="{{year}}_bond_stock[]" class="{{year}}_bond_stock" value="{% if cost_items.Bond_Stock %} {{cost_items.Bond_Stock}}{% else %} 0 {% endif %}" style="width: 100px;"></td>
            <td data-field="name" style="width: 125px;">
              <input type="text" name="{{year}}_bond_descount_cost[]" class="{{year}}_bond_descount_cost" value="{% if cost_items.Bond_Descount_Cost %} {{cost_items.Bond_Descount_Cost}}{% else %} 0 {% endif %}" style="width: 100px;"></td>
            <td><a class="delect_ed" title="Delete"><i class="fa fa-trash"></i></a></td>
         </tr>
         {% endif %}
         {% endfor %}
        {% endif %}
      </tbody>
   </table>
</div>

{% endfor %}
{% endif %}                      



</div>

<div class="row">
  <div class="col-md-2">
    <button type="submit" class="btn-block btn btn-white subbtn" data-dismiss="modal">Cancel</button>
  </div>
  <div class="col-md-3">
    <div class="form-group">
      <button type="button" class="btn-block btn btn-white subbtn" data-toggle="collapse" data-parent="#accordion" href="#collapseFour">Next</button>
    </div>
  </div>
</div>
    
      </div>
    </div>
  </div>
  
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseFour">
         
          SEO
        </a>
      </h4>
    </div>
    <div id="collapseFour" class="panel-collapse collapse">
      <div class="panel-body">
       <div class="row">
  
  

     <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="metatitle">Meta title</label>
                                                        {{form.Meta_Title}}
                                                    </div>
                                                   
                          </div>
                          <div class="col-md-6">
                           <div class="form-group">
                                                        <label for="metakeywords">Meta Keywords</label>
                                                        {{form.Meta_Keyword}}
                                                    </div>
                          </div>
     
  
  
  
  <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label for="metadescription">Meta Description</label>
                                                        {{form.Meta_Description}}
                                                    </div>
                                                </div>
     </div>
     
     <div class="row">
  <div class="col-md-2">
    <button type="submit" class="btn-block btn btn-white subbtn" data-dismiss="modal">Cancel</button>
  </div>
  <div class="col-md-2">
    <div class="form-group">
      <button type="submit" class="btn-block btn btn-white subbtn" >Save</button>
    </div>
  </div>
  <div class="col-md-3">
    <div class="form-group">
      <button type="submit" class="btn-block btn btn-white subbtn" name="_continue" value="editing">Save & Continue editing</button>
    </div>
  </div>
</div>
     
      </div>
    </div>
  </div>
    

    

</div>
</form>
</div>



          <!-- </div> -->
               </div>
      </div>
         </div>
      </div>



<div id="uploadimageModal_edit" class="modal" role="dialog">
   <div class="modal-dialog modal-lg">
      <div class="modal-content">
         <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Upload & Crop Image</h4>
         </div>
         <div class="modal-body">
            <div class="row">
               <div class="col-md-8 text-center">
                  <div id="image_demo_edit" style="width:350px; margin-top:30px"></div>
               </div>
               <div class="col-md-4" style="padding-top:30px;">
                  <br />
                  <br />
                  <br/>
                  <div class="row">
                     <div class="col-md-12 set_loader"></div>
                  </div>
                  <!--<button class="btn btn-success crop_image_edit">Crop Image</button>-->
               </div>
            </div>
         </div>
         <div class="modal-footer">
             <button class="btn btn-success crop_image_edit">Save Image</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
         </div>
      </div>
   </div>
</div>






<div id="uploadimageModal_edit_banner" class="modal" role="dialog">
   <div class="modal-dialog modal-lg">
      <div class="modal-content">
         <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Upload & Crop Image</h4>
         </div>
         <div class="modal-body">
            <div class="row">
               <div class="col-md-8 text-center">
                  <div id="image_demo_edit_banner" style="width:350px; margin-top:30px"></div>
               </div>
               <div class="col-md-4" style="padding-top:30px;">
                  <br />
                  <br />
                  <br/>
                  <div class="row">
                     <div class="col-md-12 set_loader"></div>
                  </div>
                  <!--<button class="btn btn-success crop_image_edit">Crop Image</button>-->
               </div>
            </div>
         </div>
         <div class="modal-footer">
             <button class="btn btn-success crop_image_edit_banner">Save Image</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
         </div>
      </div>
   </div>
</div>




<div id="uploadimageModal_edit_thumbnail" class="modal" role="dialog">
   <div class="modal-dialog modal-lg">
      <div class="modal-content">
         <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Upload & Crop Product Thumbnail</h4>
         </div>
         <div class="modal-body">
            <div class="row">
               <div class="col-md-8 text-center">
                  <div id="image_demo_edit_thumbnail" style="width:350px; margin-top:30px"></div>
               </div>
               <div class="col-md-4" style="padding-top:30px;">
                  <br />
                  <br />
                  <br/>
                  <div class="row">
                     <div class="col-md-12 set_loader"></div>
                  </div>
                  <!--<button class="btn btn-success crop_image_edit">Crop Image</button>-->
               </div>
            </div>
         </div>
         <div class="modal-footer">
             <button class="btn btn-success crop_image_edit_thumbnail">Save Image</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
         </div>
      </div>
   </div>
</div>

 {% endblock %}


   {% block script %}

     <script src='{% static "admin/assets/cropme/croppie_product_image.js" %}' ></script>
    <script type="text/javascript">
   $(document).ready(function() {


  $("#id_Set_To").addClass("form-control");
  $("#id_Producer_Image").addClass("form-control");
  $('.summernote_text').summernote({
        placeholder: 'Description',
        tabsize: 2,
        height: 200
      });
});

$(document).ready(function(){



$(".product_info_section").click(function(){

var get_old_year_cost_info = $("#old_year_value").val();
var get_old_year_cost_info_in_array = get_old_year_cost_info.split("|");
// console.log(get_old_year_cost_info);

// $("#show_vintage_year_stock_data").html('');


// console.log(get_year_for_remove);

var get_year_for_remove = new Array();

$(".yearwine").each(function(){

// console.log($(this).text());
get_year_for_remove.push($(this).text());

});

var get_year_for_new = new Array();

$("#id_Vintage option:selected").each(function(){


 var  vintage_year =  $(this).text();
get_year_for_new.push(vintage_year);
 console.log(vintage_year);
 if(get_old_year_cost_info_in_array.indexOf(vintage_year) == -1 && get_year_for_remove.indexOf(vintage_year) == -1)
 {

  $("#show_vintage_year_stock_data").append('<div class="since_'+vintage_year+'"><table width="100%" border="1" class="table table-striped table-bordered newpage editableTable" align="center" cellpadding="0" cellspacing="0" style=" font-size: 15px;"><thead><tr style="cursor: pointer;"><td colspan="9"><div class="yearwine"><span>'+vintage_year+'<span></span></span></div></td><td><div class="add_button year_add add_rows" data-vintage_year="'+vintage_year+'"> <a class="add-row"><i class="fa fa-plus"></i>Add Row</a></div></td></tr><tr style="cursor: pointer;"><th align="left" valign="top">Bottle</th><th align="left" valign="top">Retail Cost</th><th align="left" valign="top">Retail Stock</th><th align="left" valign="top">Discount Cost</th><th align="left" valign="top">Duty</th><th align="left" valign="top">GST (%)</th><th align="left" valign="top">Bond Cost</th><th align="left" valign="top">Bond Stock</th><th align="left" valign="top">Bond Descount Cost</th><th align="left" valign="top">Action</th></tr></thead><tbody class="add_row_'+vintage_year+'"></tbody></table></div>');
 }


});


for(var i=0; i<get_year_for_remove.length; i++)
{
   if(get_year_for_new.indexOf(get_year_for_remove[i]) == -1)
   {
    $(".since_"+get_year_for_remove[i]).remove();
   }
}


});


$(".click_to_stope_submit").click(function(e){

var set_status = true;

$("#show_error_message_Select_Type").text('');
$("#show_error_message_Product_name").text('');
$("#show_error_message_Producer").text('');
$("#show_error_message_Country").text('');
$("#show_error_message_Regions").text('');

$("#show_error_message_Category").text('');
$("#show_error_message_Color").text('');
$("#show_error_message_Appellation").text('');
$("#show_error_message_Bottel_Size").text('');
$("#show_error_message_Classification").text('');
$("#show_error_message_Vintage").text('');
$("#show_error_message_Grape").text('');
$("#show_error_message_Varietals").text('');

$("#show_error_message").html('');
if($("#id_Select_Type").val()=="")
{
  set_status =false;
  $("#show_error_message_Select_Type").text('Please select Type.');
}
if($("#id_Product_name").val()=="")
{
  set_status =false;
  $("#show_error_message_Product_name").text('Product name is required.');
}
if($("#id_Producer").val()=="")
{
  set_status =false;
  $("#show_error_message_Producer").text('Please select producer.');
}
if($("#id_Country").val()=="")
{
  set_status =false;
  $("#show_error_message_Country").text('Please select country.');
}
if($("#id_Regions").val()=="")
{
  set_status =false;
  $("#show_error_message_Regions").text('Please select regions.');
}


if($("#id_Category").val()=="")
{
  set_status =false;
  $("#show_error_message_Category").text('Please select category.');
}
if($("#id_Color").val()=="")
{
  set_status =false;
  $("#show_error_message_Color").text('Please select color.');
}
if($("#id_Appellation").val()=="")
{
  set_status =false;
  $("#show_error_message_Appellation").text('Please select appellation.');
}
if($("#id_Bottel_Size").val()=="")
{
  set_status =false;
  $("#show_error_message_Bottel_Size").text('Please select bottel size.');
}
if($("#id_Classification").val()=="")
{
  set_status =false;
  $("#show_error_message_Classification").text('Please select classification.');
}

if($("#id_Vintage").val()=="")
{
  set_status =false;
  $("#show_error_message_Vintage").text('Please select vintage.');
}

if($("#id_Grape").val()=="")
{
  set_status =false;
  $("#show_error_message_Grape").text('Please select grape.');
}

if($("#id_Varietals").val()=="")
{
  set_status =false;
  $("#show_error_message_Varietals").text('Please select varietals.');
}



console.log(set_status);
if(set_status)
{
   $("#first_tab").addClass('collapsed');
  $("#collapseOne").removeClass('in');
  $("#collapseOne").removeClass('show');
   
   $("#second_tab").removeClass('collapsed');
   $("#collapseTwo").addClass('in');
   $("#collapseTwo").addClass('show');

}
else{
  e.preventDefault();
   $("#show_error_message").html('<div class="alert alert-danger alert-dismissible"><a href="#" class="close" data-dismiss="alert" aria-label="close" style="color: crimson!important">&times;</a><strong>Some field is required.</strong></div>');
}


});
});

$(document).on("click",'.remove_div',function(){

      $(this).closest(".remove_this_div").remove();
});


 </script>
      {% endblock %}
